<% content_for :title do %>
  Detalhes de Raffle
<% end %>

<div class="page-header">
  <h1>Detalhes de Raffle</h1>
  <div>
    <%= link_to edit_raffle_path(@raffle), class: 'btn btn-success' do %>
      <%= icon 'fas', 'edit' %>
      Editar
    <% end %>
    <%= link_to raffles_path, class: 'btn btn-outline-secondary' do %>
      <%= icon 'fas', 'bars' %>
      Voltar
    <% end %>
  </div>
</div>

<dl class="dl-horizontal">
  <dt>Created By:</dt>
  <dd><%= @raffle.user.name %></dd>

  <dt>Raffle type:</dt>
  <dd><%= @raffle.type.description %></dd>

  <dt>Title:</dt>
  <dd><%= @raffle.title %></dd>

  <dt>Description:</dt>
  <dd><%= @raffle.description %></dd>

  <dt>Raffle date:</dt>
  <dd><%= @raffle.raffle_date %></dd>

  <dt>Init date:</dt>
  <dd><%= @raffle.init_date %></dd>

  <dt>Final date:</dt>
  <dd><%= @raffle.final_date %></dd>

  <dt>Value:</dt>
  <dd><%= @raffle.value %></dd>

  <h1>Tickets:</h1>

  <% flash.each do |type, msg| %>
    <div class="alert alert-info">
      <%= msg %>
    </div>
  <% end %>

  <div class="table-responsive">
  <table class="table table-striped table-bordered table-hover">
    <thead>
      <tr>
        <th>Raffle</th>
        <th>Purchased?</th>
        <th>Number</th>
        <th></th>
      </tr>
    </thead>

    <tbody>
      <% @tickets.each do |ticket| %>
        <tr>
          <td><%= ticket.raffle.title %></td>
          <td>
            <% if ticket.user %>
              <span class="badge badge-danger">Purchased</span>
            <% else %>
              <span class="badge badge-success">Available</span>
            <% end%>
          </td>
          <td><%= ticket.number %></td>
          <td>
            <%= link_to ticket, class: 'btn btn-info btn-sm' do %>
              <%= icon 'fas', 'eye', class: 'fa-fw' %>
            <% end %>
            <%= link_to edit_ticket_path(ticket), class: 'btn btn-success btn-sm' do %>
              <%= icon 'fas', 'edit', class: 'fa-fw' %>
            <% end %>
            <%= link_to ticket, method: :delete, data: { confirm: 'VocÃª tem certeza?' }, class: 'btn btn-danger btn-sm' do %>
              <%= icon 'fas', 'times', class: 'fa-fw' %>
            <% end %>
            <% if !ticket.user %>

            <%= link_to "#{root_url}tickets/purchase/#{ticket.id}", method: :get, data: { confirm: 'Do you want to buy this ticket?' }, class: 'btn btn-warning btn-sm' do %>
              <%= icon 'fas', 'shopping-cart', class: 'fa-fw' %>
            <% end %>

            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>  

  <hr>

  <%= paginate @tickets %>


</dl>
